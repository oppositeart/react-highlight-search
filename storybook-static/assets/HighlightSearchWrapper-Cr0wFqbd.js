import{r as h,R as D}from"./index-Cp6HKLZC.js";function N(e){const a=h.useRef();return h.useEffect(()=>{a.current=e},[e]),a.current}const k=e=>{e!==void 0&&e.forEach(({newNodes:a,oldNode:s,parentNode:i})=>{const n=a[a.length-1].nextSibling||null;i==null||i.insertBefore(s,n),a.forEach(l=>{l.remove()})})},A=()=>{const e=[];return{matchData:e,matchDataController:({index:s,node:i,startPos:n,endPos:l})=>{var r;e[s]?(r=e[s].positionsArr)==null||r.push({startPos:n,endPos:l}):e[s]={node:i,positionsArr:[{startPos:n,endPos:l}]}}}},_=(e,a,s)=>{const i=[];e.forEach(({node:n,positionsArr:l})=>{const r=n.parentNode,m=n.nextSibling||null,c=n.textContent,d=[],E=[];l.forEach(({startPos:u,endPos:t},f)=>{var o;u!==t&&(f<1&&d.push((c==null?void 0:c.slice(0,u))||""),d.push((c==null?void 0:c.slice(u,t))||""),d.push((c==null?void 0:c.slice(t,((o=l[f+1])==null?void 0:o.startPos)||c.length))||""))}),n.remove(),d.forEach((u,t)=>{if(u){let f=document.createTextNode(u);if(t%2!==0){const o=document.createElement("span");s&&o.classList.add(s),o.appendChild(f),E.push(o),r==null||r.insertBefore(o,m)}else E.push(f),r==null||r.insertBefore(f,m)}}),i.push({newNodes:E,oldNode:n,parentNode:r})}),a(i)},B=(e,a,s,i)=>{var E,u;let n=0,l=0,r=-1,m=-1,c=0,d=0;for(let t=0;t<e.length&&(l=n+(((u=(E=e[t])==null?void 0:E.textContent)==null?void 0:u.length)||1)-1,a>=n&&a<=l&&(r=t,c=a-n),s>=n&&s<=l&&(m=t,d=s-n+1),(r===t||m===t)&&i({index:t,node:e[t],startPos:r===t?c:0,endPos:m===t?d:l+1}),n=l+1,!(m>-1));t++);},w=1,T=({searchString:e,setTriggerSearch:a,searchMinLength:s=w,onMatchData:i,children:n,spanClassName:l="hlsearch-span-el",ignoreCase:r=!0,index:m=0})=>{const c=h.useRef(null),d=h.useRef(null),[E,u]=h.useState(),t=N(e),f=h.useCallback(v=>{i==null||i({wrapperIndex:m,matchesFound:v,matchParentElement:v?c.current:null})},[m,i]),o=h.useCallback(v=>{var S;if(f(0),k(E),(v==null?void 0:v.length)<(s>0?s:w)){u(void 0);return}const R=[],x=p=>{p==null||p.forEach(g=>{g.nodeType===g.ELEMENT_NODE?x(g.childNodes):g.nodeType===g.TEXT_NODE&&R.push(g)})};if(x((S=d.current)==null?void 0:S.childNodes),!R.length)return;let y="";R.forEach(p=>{y+=p.textContent});const q=new RegExp(v,r?"ig":"g"),C=y.matchAll(q);let b=0;const{matchData:H,matchDataController:I}=A();for(const p of C){if(p.index===void 0)return;b++,B(R,p.index,p.index+p[0].length-1,I)}f(b),_(H,u,l)},[r,E,s,f,l]);return h.useEffect(()=>{e!==void 0&&e!==t&&o(e)},[t,e,o]),h.useEffect(()=>{a==null||a(()=>v=>o(v))},[a,o]),D.createElement("div",{ref:c},D.createElement("div",{ref:d},n))},O=h.memo(T);T.__docgenInfo={description:"",methods:[],displayName:"HighlightSearchWrapper",props:{searchString:{required:!0,tsType:{name:"string"},description:""},setTriggerSearch:{required:!1,tsType:{name:"ReactDispatch",raw:`React.Dispatch<
    React.SetStateAction<((text: string) => void) | undefined>
>`,elements:[{name:"ReactSetStateAction",raw:"React.SetStateAction<((text: string) => void) | undefined>",elements:[{name:"union",raw:"((text: string) => void) | undefined",elements:[{name:"unknown"},{name:"undefined"}]}]}]},description:""},searchMinLength:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"1",computed:!1}},onMatchData:{required:!1,tsType:{name:"signature",type:"function",raw:"(matchData: OnMatchDataPropsType) => void",signature:{arguments:[{type:{name:"signature",type:"object",raw:`{
    wrapperIndex: number;
    matchesFound: number;
    matchParentElement: HTMLDivElement | null;
}`,signature:{properties:[{key:"wrapperIndex",value:{name:"number",required:!0}},{key:"matchesFound",value:{name:"number",required:!0}},{key:"matchParentElement",value:{name:"union",raw:"HTMLDivElement | null",elements:[{name:"HTMLDivElement"},{name:"null"}],required:!0}}]}},name:"matchData"}],return:{name:"void"}}},description:""},children:{required:!0,tsType:{name:"union",raw:"React.ReactElement | JSX.Element",elements:[{name:"ReactReactElement",raw:"React.ReactElement"},{name:"JSX.Element"}]},description:""},spanClassName:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:'"hlsearch-span-el"',computed:!1}},ignoreCase:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}},index:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"0",computed:!1}}}};export{O as H,N as u};
