import{r as E,R}from"./index-Cp6HKLZC.js";function w(e){const s=E.useRef();return E.useEffect(()=>{s.current=e},[e]),s.current}const I=e=>{e!==void 0&&e.forEach(({newNodes:s,oldNode:r,parentNode:o})=>{const n=s[s.length-1].nextSibling||null;o==null||o.insertBefore(r,n),s.forEach(l=>{l.remove()})})},H=()=>{const e=[];return{matchData:e,matchDataController:({index:r,node:o,startPos:n,endPos:l})=>{var a;e[r]?(a=e[r].positionsArr)==null||a.push({startPos:n,endPos:l}):e[r]={node:o,positionsArr:[{startPos:n,endPos:l}]}}}},N=(e,s,r)=>{const o=[];e.forEach(({node:n,positionsArr:l})=>{const a=n.parentNode,h=n.nextSibling||null,c=n.textContent,p=[],f=[];l.forEach(({startPos:u,endPos:t},i)=>{var m;u!==t&&(i<1&&p.push((c==null?void 0:c.slice(0,u))||""),p.push((c==null?void 0:c.slice(u,t))||""),p.push((c==null?void 0:c.slice(t,((m=l[i+1])==null?void 0:m.startPos)||c.length))||""))}),n.remove(),p.forEach((u,t)=>{if(u){let i=document.createTextNode(u);if(t%2!==0){const m=document.createElement("span");r&&m.classList.add(r),m.appendChild(i),f.push(m),a==null||a.insertBefore(m,h)}else f.push(i),a==null||a.insertBefore(i,h)}}),o.push({newNodes:f,oldNode:n,parentNode:a})}),s(o)},k=(e,s,r,o)=>{var f,u;let n=0,l=0,a=-1,h=-1,c=0,p=0;for(let t=0;t<e.length&&(l=n+(((u=(f=e[t])==null?void 0:f.textContent)==null?void 0:u.length)||1)-1,s>=n&&s<=l&&(a=t,c=s-n),r>=n&&r<=l&&(h=t,p=r-n+1),(a===t||h===t)&&o({index:t,node:e[t],startPos:a===t?c:0,endPos:h===t?p:l+1}),n=l+1,!(h>-1));t++);},T=({searchString:e,searchMinLength:s=1,onMatchData:r,children:o,spanClassName:n="highlightsearch-selected-element",index:l=0})=>{const a=E.useRef(null),h=E.useRef(null),[c,p]=E.useState(),f=w(e),u=E.useCallback(i=>{r==null||r({wrapperIndex:l,matchesFound:i,matchParentElement:i?a.current:null})},[l,r]),t=E.useCallback(i=>{var x;if(u(0),I(c),(i==null?void 0:i.length)<(s>0?s:1))return;const m=[],v=d=>{d==null||d.forEach(g=>{g.nodeType===g.ELEMENT_NODE?v(g.childNodes):g.nodeType===g.TEXT_NODE&&m.push(g)})};if(v((x=h.current)==null?void 0:x.childNodes),!m.length)return;let y="";m.forEach(d=>{y+=d.textContent});const C=new RegExp(i,"ig"),D=y.matchAll(C);let b=0;const{matchData:S,matchDataController:q}=H();for(const d of D){if(d.index===void 0)return;b++,k(m,d.index,d.index+d[0].length-1,q)}u(b),N(S,p,n)},[c,u]);return E.useEffect(()=>{e!==void 0&&e!==f&&t(e)},[f,e,t]),R.createElement("div",{ref:a},R.createElement("div",{ref:h},o))},L=E.memo(T);T.__docgenInfo={description:"",methods:[],displayName:"HighlightSearchWrapper",props:{searchString:{required:!0,tsType:{name:"string"},description:""},searchMinLength:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"1",computed:!1}},onMatchData:{required:!1,tsType:{name:"signature",type:"function",raw:"(matchData: OnMatchDataPropsType) => void",signature:{arguments:[{type:{name:"signature",type:"object",raw:`{
    wrapperIndex: number;
    matchesFound: number;
    matchParentElement: HTMLDivElement | null;
}`,signature:{properties:[{key:"wrapperIndex",value:{name:"number",required:!0}},{key:"matchesFound",value:{name:"number",required:!0}},{key:"matchParentElement",value:{name:"union",raw:"HTMLDivElement | null",elements:[{name:"HTMLDivElement"},{name:"null"}],required:!0}}]}},name:"matchData"}],return:{name:"void"}}},description:""},children:{required:!0,tsType:{name:"union",raw:"React.ReactElement | JSX.Element",elements:[{name:"ReactReactElement",raw:"React.ReactElement"},{name:"JSX.Element"}]},description:""},spanClassName:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:'"highlightsearch-selected-element"',computed:!1}},index:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"0",computed:!1}}}};export{L as H};
